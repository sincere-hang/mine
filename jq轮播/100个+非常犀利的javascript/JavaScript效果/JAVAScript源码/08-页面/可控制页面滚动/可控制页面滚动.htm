<html>
<head>
<style type="text/css">
#item {position:absolute; visibility:hidden; left:0px}
</style>

<SCRIPT LANGUAGE="JavaScript">
<!-- Begin
var isNS=(document.layers);				//判断是否为NS的标志
var _all=(isNS)? '' : 'all.' ;				//以下根据是否为NS生成表示文档对象属性的字符串
var _style=(isNS)? '' : '.style' ;
var _visible=(isNS)? 'show' : 'visible';
var w_x, w_y, item, okscroll=false, godown;		//声明常用变量

function init(){					//这个函数用来进行页面初始化
item=eval('document.'+_all+'item'+_style);		//定位操作对象item
getwindowsize();					//取窗口尺寸以定位浮动层
item.visibility=_visible;				//将层设为可见
scrollpage();						//开始滚动页面
}

function getwindowsize() {
w_x=(isNS)? window.innerWidth-5 : document.body.clientWidth;	//取窗口宽度
w_y=(isNS)? window.innerHeight : document.body.clientHeight;	//取窗口高度
(isNS)? item.clip.width=42: item.width=42;			//设定浮动层宽度
(isNS)? item.clip.height=20 : item.height=20;			//设定浮动层高度
moveitem();							//定位浮动层
}

function resizeNS() {						//在浏览器是NS的情况下
setTimeout('document.location.reload()',400);			//只有用刷新的办法处理onresize事件
}

function moveitem() {						//这个函数用来定位浮动层。
if (isNS) {							//如果是NS
item.moveTo((pageXOffset+w_x-70),(w_y+pageYOffset-50))		//利用moveTo来定位层
}else{								//否则(是IE)
item.pixelLeft=document.body.scrollLeft+w_x-70;			//用改变坐标属性的方法定位层
item.pixelTop=w_y+document.body.scrollTop-100;
   }
}
window.onload=init;						//设定初始化动作
(isNS) ? window.onresize=resizeNS : window.onresize=getwindowsize;//根据浏览器的不同设定当页面大小被改变时的处理方法。

function scrollpage() {						//这个函数用来根据需要卷动页面
status = '';							//消隐提示栏出现的"javascript:void(0)"无用信息
if (okscroll) {							//如果允许滚动
if (godown) {							//根据方向，利用scrollBy实现滚动操作
(isNS)? window.scrollBy(0,4) : window.scrollBy(0,4) ;
} else {
(isNS)? window.scrollBy(0,-4) : window.scrollBy(0,-4) ;
   }
}
moveitem();							//滚动以后重设浮动层的位置
setTimeout('scrollpage()', 40);					//设定下一次滚动页面的延时
}
//  End -->
</script>

<title>可控制页面滚动的特效</title>
</head>
<body >
<div id="item">
<a href="javascript:void(0)" onMouseover="okscroll=true; godown=false" onMouseout="okscroll=false">
<img src="images/up.gif" border="0"></a>
<p>
<a href="javascript:void(0)" onMouseover="okscroll=true; godown=true" onMouseout="okscroll=false">
<img src="images/down.gif" border="0"></a>
</div>
1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>

</body>
</html>
